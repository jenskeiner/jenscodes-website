{{ define "main" }}
  {{- $project := index .Page.Params "_project" -}}
  {{- $version := index .Page.Params "_version" -}}
  {{- $params := index .Site.Params $project -}}
  {{- $menuName := index .Page.Params "_menu" -}}
  {{- if not $menuName -}}
    {{- $menuName = "lintr" -}}
  {{- end -}}
  {{- $menu := index .Site.Menus $menuName -}}
  <div class="w-full mt-48 max-w-7xl mx-auto pb-16 px-12 md:mt-18 lg:px-0">
    <div class="lg:flex">
      <!-- Sidebar -->
      <div
        class="hidden z-10 lg:flex-none h-full lg:flex lg:pt-0 lg:static lg:h-auto lg:overflow-y-visible lg:pt-0 lg:w-60 xl:w-80 lg:block"
      >
        <div
          class="h-[94vh] top-8 overflow-y-auto scrolling-touch lg:h-[94vh] lg:block lg:relative lg:sticky overflow-hidden lg:top-8 mr-24 lg:mr-0"
        >
          <nav
            id="documentation-menu"
            class="px-1 overflow-y-auto font-medium text-base sm:px-3 xl:px-5 lg:text-sm sticky?lg:h-(screen-18)"
          >
            <ul>
              {{ range sort $menu "Weight" }}
                  <li class="pb-6">
                    {{ $render := $.IsMenuCurrent .Menu .}}
                    {{ if and (not $render) .HasChildren }}
                      {{ range .Children }}
                        {{ if $.IsMenuCurrent .Menu . }}
                          {{ $render = true }}
                        {{ end }}
                      {{ end }}
                    {{ end }}
                    <a
                      href="{{ .Page.RelPermalink }}"
                      class="text-2xl {{ if $render }}
                        text-green-500 dark:text-green-300
                      {{ end }}"
                      >{{ index (split .Name "|") 0 -}}</a
                    >
                    {{ if $render }}
                      {{ .Page.TableOfContents }}
                    {{ end }}
                  </li>
              {{ end }}
            </ul>
          </nav>
        </div>
      </div>
      <!-- /Sidebar -->

      <!-- Content -->
      <main
        id="docs"
        class="min-w-0 w-full lg:px-12 lg:flex-auto lg:static lg:max-h-full lg:overflow-visible"
        data-controller="clipboard"
      >
        <h1 class="doc-title">{{ index (split .Name "|") 0 -}}</h1>
        {{ .TableOfContents }}

        {{- $content := .Content -}}
        {{ $content = $content | replaceRE "(<h[1-9] id=\"([^\"]+)\".+)(</h[1-9]+>)" `${1} <a href="#${2}" class="header-link"
          aria-label="Permanent link">#</a> ${3}` | safeHTML
        }}
        {{ $content = $content | replaceRE "(<table[^>]*>(?:.|\n)+?</table>)" `<div class="table-wrapper">${1}</div>` | safeHTML }}
        {{ $content }}
      </main>
      <!-- /Content -->
    </div>
  </div>
{{ end }}
